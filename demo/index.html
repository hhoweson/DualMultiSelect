<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Dual MultiSelect</title>

        <script type="module" src="./demo.ts"></script>

        <!-- Bootstrap (not required for DualMultiSelect) -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

        <style>
            html {
                font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
            }

            section {
                background-color: #f9f9f9;
                border: 1px solid #ddd;
                border-radius: 8px;
                margin-bottom: 20px;
                padding: 20px;
            }

            a {
                text-decoration: none;
            }

            #dualMultiSelectVersion {
                font-size: 16px;
                color: #666;
            }

            .header-container {
                display: flex;
                align-items: center;
            }

            .codeBlock {
                background-color: #e0e0e0 !important;
                padding: 6px !important;
                border-radius: 4px;
                display: block;
                margin: 5px 0;
            }

            /* The following rules are for elements created by JS when it replaces the ".exampleCodeTemplate"s with actual examples */
            .exampleContainer {
                display: flex;
            }
            .exampleContainer .example {
                min-width: 500px;
            }
            .exampleCode {
                min-width: 0;
                border-right: 1px solid #ddd;
                padding-right: 20px;
                margin-right: 20px;
                flex: 1;
            }
            .exampleCode > *:not(:last-child) {
                margin-bottom: 10px;
            }
            .exampleCode code {
                background-color: #e0e0e0;
                padding: 10px;
                border-radius: 4px;
                display: block;
            }
            pre {
                padding: 0;
                margin: 0;
                overflow-x: scroll;
            }
        </style>
    </head>
    <body>

        <div class="container mt-3">

            <section>

                <div class="header-container mb-2">
                    <a id="githubLink" href="https://github.com/hhoweson/DualMultiSelect" class="me-2">
                        <img src="./github-mark.svg" alt="GitHub Logo" style="width: 30px; height: 30px;">
                    </a>
                    <h2 class="d-inline-block m-0">
                        DualMultiSelect
                        <small id="dualMultiSelectVersion">
                            v<span class="versionNumber"></span>
                        </small>
                    </h2>
                </div>

                <h5>A free, simple and lightweight dual listbox plugin implemented with pure JavaScript.</h5>
                <ul>
                    <li>Free (under MIT license)</li>
                    <li>Open source</li>
                    <li>Lightweight</li>
                    <li>Fully customizable via CSS</li>
                    <li>Requires no custom handling since it uses the original select element</li>
                </ul>

            </section>

            <section>

                <h4>Getting Started</h4>

                <p>
                    DualMultiSelect integrates seamlessly with existing select elements, allowing you to use them without modifying your code.<br>
                    Include the script using one of the methods below and follow the usage examples to get started.
                </p>

                <h5>Installation Options</h5>

                <p>
                    Install via npm:
                    <code class="codeBlock">npm install dualmultiselect</code>
                </p>
                <p>
                    Include via CDN:
                    <code class="codeBlock" id="cdnScriptTag">
                        <!-- Populated by JS -->
                    </code>
                    <code class="codeBlock" id="cdnCssTag">
                        <!-- Populated by JS -->
                    </code>
                </p>
                <p>
                    Or download from <a href="https://github.com/hhoweson/DualMultiSelect/releases">GitHub</a>.
                </p>

                <h5>Usage</h5>

                <template class="exampleCodeTemplate">

                    <script>
                        const basicSelect = document.querySelector("#basicSelect");
                        new DualMultiSelect(basicSelect);
                    </script>

                    <select multiple="multiple" id="basicSelect">
                        <option value="1" disabled>Option 1</option>
                        <option value="2">Option 2</option>
                        <option value="3">Option 3</option>
                        <optgroup label="Group 1">
                            <option value="4" selected>Option 4</option>
                            <option value="5">Option 5</option>
                        </optgroup>
                    </select>

                </template>

            </section>

            <section id="api">
                <h4>API</h4>

                <p>
                    Since DualMultiSelect uses the original select element, you can use the same methods and properties you would use with a normal select element.<br>
                    Additionally, when an option is selected, the <code>change</code> event is fired on the original select element allowing you to use event listeners as you normally would.<br>
                    There is one caveat to this, which involves changing/selecting options:
                </p>

                <p>
                    <h5>Changing/Selecting Options</h5>
                    If you modify the selected options or HTML markup of the original &lt;select&gt; element programmatically, you must trigger the <code>change</code> event to update the DualMultiSelect instance:<br>
                    <code class="codeBlock">document.querySelector('#mySelect').dispatchEvent(new Event('change'));</code>
                </p>

                <p>
                    <h5>Methods</h5>
                    <ul>
                        <li><code>setData(<a href="#types">UniversalOptionData</a>)</code> - Can be used to programmatically set/update the select options</li>
                        <li><code>getData()</code> - Can be used to get the select options as <a href="#types">UniversalOptionData</a></li>
                        <li><code>destroy()</code> - Destroys the DualMultiSelect instance and allows you to continue using the original select element in it's current state</li>
                    </ul>
                </p>

            </section>

            <section>
                <h4>Styling</h4>

                <p>
                    DualMultiSelect is fully customizable via CSS.<br>
                    Feel free to use inspect element to see the structure of the elements and the classes used and overwrite the styling however you like.<br>
                </p>

            </section>

            <section id="options">
                <h4>Options</h4>

                <i>All options are optional</i>

                <table class="table table-bordered mt-2">
                    <thead>
                        <tr>
                            <th>Option</th>
                            <th>Type</th>
                            <th>Default</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><a href="#customDataExample">data</a></td>
                            <td><a href="#types">UniversalOptionData</a></td>
                            <td>null</td>
                            <td>The data to initialize the DualMultiSelect element with. This will overwrite any current options</td>
                        </tr>
                        <tr>
                            <td><a href="#searchBarExample">searchBar</a></td>
                            <td>boolean | <a href="#types">SearchFunction</a></td>
                            <td>false</td>
                            <td>Set to true to create a searchbar above the selectableList. If you want to use a custom <a href="#types">SearchFunction</a> pass that instead. <i>*not compatible with selectableHeader</i></td>
                        </tr>
                        <tr>
                            <td><a href="#stackedListsExample">stackLists</a></td>
                            <td>boolean</td>
                            <td>false</td>
                            <td>Whether to stack the lists on top of each other instead of side by side</td>
                        </tr>
                        <tr>
                            <td><a href="#stickyHeadersExample">stickyHeaders</a></td>
                            <td>boolean</td>
                            <td>false</td>
                            <td>Whether to make the option group headers sticky</td>
                        </tr>
                        <tr>
                            <td><a href="#customHeadersExample">selectableHeader</a></td>
                            <td>HTMLElement | string</td>
                            <td>null</td>
                            <td>Custom header for the selectable list</td>
                        </tr>
                        <tr>
                            <td><a href="#customHeadersExample">selectedHeader</a></td>
                            <td>HTMLElement | string</td>
                            <td>null</td>
                            <td>Custom header for the selected list <i>*not compatible with searchbar</i></td>
                        </tr>
                    </tbody>
                </table>

            </section>

            <section id="types">

                <h4>Types</h4>

                <p class="mt-4">
                    <b>UniversalOptionData</b> should be an array containing a combination of <code>OptionElementData</code> and <code>OptGroupElementData</code> objects:
                </p>
                
                <div style="margin-left: 20px;">
                    <b>OptionElementData</b> (represents an <code>&lt;option&gt;</code> element):
                    <table class="table table-bordered mt-2">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Default</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>text</td>
                                <td>string (required)</td>
                                <td>N/A</td>
                                <td>The text of the option or group</td>
                            </tr>
                            <tr>
                                <td>value</td>
                                <td>string</td>
                                <td>null</td>
                                <td>The value of the option or group</td>
                            </tr>
                            <tr>
                                <td>selected</td>
                                <td>boolean</td>
                                <td>false</td>
                                <td>Whether the option is selected or not</td>
                            </tr>
                            <tr>
                                <td>disabled</td>
                                <td>boolean</td>
                                <td>false</td>
                                <td>Whether the option is disabled or not</td>
                            </tr>
                            <tr>
                                <td>hidden</td>
                                <td>boolean</td>
                                <td>false</td>
                                <td>
                                    Whether the option is hidden or not (used for searching/filtering options).<br>
                                    When all child options of an optGroup are hidden, the optGroup will also be hidden
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <b>OptGroupElementData</b> (represents an <code>&lt;optgroup&gt;</code> element):
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Property</th>
                                <th>Type</th>
                                <th>Default</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>label</td>
                                <td>string (required)</td>
                                <td>N/A</td>
                                <td>The label of the group</td>
                            </tr>
                            <tr>
                                <td>children</td>
                                <td>Array (required)</td>
                                <td>N/A</td>
                                <td>An array of OptionElementData objects</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <p class="mt-5">
                    <b>SearchFunction</b> - A function that takes the search query, an <code>OptionElementData</code> object and the parent <code>OptGroupElementData</code> object (if applicable) and returns a boolean.<br>
                    The function should return true if the option should be shown or false if it should be hidden. Here is an example search function:
                </p>

                <pre><code class="codeBlock"><!--
                 -->function searchFunction(searchQuery, optionData, optGroupData) => {
<!--             -->    const query = searchQuery.toLowerCase();
<!--             -->    return optionData.text.toLowerCase().includes(query) || (optGroupData && optGroupData.label.toLowerCase().includes(query));
<!--             -->}<!--
             --></code></pre>

            </section>

            <section id="customDataExample">

                <h4>Custom Data Example</h4>

                <p>
                    Here is an example of using DualMultiSelect with custom data via the <code>data</code> option. The data format is the same when using the <code>.setData()</code> method.<br>
                    Note that any current options are overwritten.
                </p>

                <template class="exampleCodeTemplate">

                    <script>
                        const customDataSelect = document.querySelector("#customDataSelect");
                        new DualMultiSelect(customDataSelect, {
                            data: [
                                { text: 'Option 1', value: '1' },
                                { text: 'Option 2', value: '1', selected: true },
                                { text: 'Option 3', value: '1', selected: true, disabled: true },
                                { label: 'Group 1', children: [
                                    { text: 'Group Option 1', value: '1' },
                                    { text: 'Group Option 2', value: '1', selected: true },
                                    { text: 'Group Option 3', value: '1', selected: true, disabled: true }
                                ]}
                            ]
                        });
                    </script>

                    <select multiple="multiple" id="customDataSelect">
                        <option value="1" disabled>This option will be overwritten</option>
                    </select>

                </template>

            </section>

            <section id="searchBarExample">

                <h4>Search Bar Example</h4>

                <p>
                    Setting the <code>searchBar</code> option to true will show a search bar above the selectable list.<br>
                    The search bar will filter both lists by checking if the option group label, or option text contain the search term (case-insensitive).<br>
                    Option groups will only be hidden if all their child options are also hidden.
                </p>

                <template class="exampleCodeTemplate">

                    <script>
                        const searchBarSelect = document.querySelector("#searchBarSelect");
                        new DualMultiSelect(searchBarSelect, {
                            searchBar: true
                        });
                    </script>

                    <select multiple="multiple" id="searchBarSelect">
                        <option value="1" disabled>Option 1</option>
                        <option value="2">Option 2</option>
                        <option value="3">Option 3</option>
                        <optgroup label="Group 1">
                            <option value="4" selected>Option 4</option>
                            <option value="5">Option 5</option>
                        </optgroup>
                    </select>

                </template>

            </section>

            <section id="stackedListsExample">

                <h4>Stacked Lists Example</h4>

                <p>
                    The lists can be stacked on top of each other by setting the <code>stackLists</code> option to true.
                </p>

                <template class="exampleCodeTemplate">

                    <script>
                        const stackedListsSelect = document.querySelector("#stackedListsSelect");
                        new DualMultiSelect(stackedListsSelect, {
                            stackLists: true
                        });
                    </script>

                    <select multiple="multiple" id="stackedListsSelect">
                        <option value="1" disabled>Option 1</option>
                        <option value="2">Option 2</option>
                        <option value="3">Option 3</option>
                        <optgroup label="Group 1">
                            <option value="4" selected>Option 4</option>
                            <option value="5">Option 5</option>
                        </optgroup>
                    </select>

                </template>

            </section>

            <section id="stickyHeadersExample">

                <h4>Sticky Headers Example</h4>

                <p>
                    The option group headers can be made sticky by setting the <code>stickyHeaders</code> option to true.
                </p>

                <template class="exampleCodeTemplate">

                    <script>
                        // Generate Data
                        const stickyHeadersData = [];
                        for(let i = 0; i < 10; i++) {
                            stickyHeadersData.push({ label: `Group ${i + 1}`, children: [] });
                            for(let j = 0; j < 10; j++) {
                                stickyHeadersData[i].children.push({ text: `Option ${i}${j}` });
                            }
                        }
                        // Actual Code
                        const stickyHeadersSelect = document.querySelector("#stickyHeadersSelect");
                        new DualMultiSelect(stickyHeadersSelect, {
                            data: stickyHeadersData,
                            stickyHeaders: true
                        });
                    </script>

                    <select multiple="multiple" id="stickyHeadersSelect"></select>

                </template>


            </section>

            <section id="customHeadersExample">

                <h4>Custom Headers Example</h4>

                <p>
                    You can add custom headers to the lists by passing an HTMLElement or a string to the <code>selectableHeader</code> or <code>selectedHeader</code> options. Alternatively you could override the css of the default headers to achieve the desired effect.
                </p>

                <template class="exampleCodeTemplate">

                    <script>
                        // Create custom header
                        const customHeader = document.createElement('h5');
                        customHeader.textContent = 'Custom Header';
                        customHeader.style.textAlign = 'center';
                        // Actual Code
                        const customHeadersSelect = document.querySelector("#customHeadersSelect");
                        new DualMultiSelect(customHeadersSelect, {
                            selectableHeader: customHeader,
                            selectedHeader: 'Selected Options'
                        });
                    </script>

                    <select multiple="multiple" id="customHeadersSelect">
                        <option value="1" disabled>Option 1</option>
                        <option value="2">Option 2</option>
                        <option value="3">Option 3</option>
                        <optgroup label="Group 1">
                            <option value="4" selected>Option 4</option>
                            <option value="5">Option 5</option>
                        </optgroup>
                    </select>

                </template>

            </section>

            <section>

                <h4>Torture Test</h4>

                <p>
                    DualMultiSelect has been tested with 5000 options: 50 option groups, each with 100 options. The performance is acceptable, but it may be slow on older devices.<br>
                    The following example demonstrates the performance of DualMultiSelect with a large number of options.
                </p>

                <template class="exampleCodeTemplate">

                    <script>
                        // Generate Data
                        const tortureTestData = [];
                        for(let i = 0; i < 50; i++) {
                            tortureTestData.push({ label: `Group ${i+1}`, children: [] });
                            for(let j = 0; j < 100; j++) {
                                tortureTestData[i].children.push({ text: `Option ${i+1}-${j+1}` });
                            }
                        }
                        // Actual Code
                        const tortureTestSelect = document.querySelector("#tortureTestSelect");
                        new DualMultiSelect(tortureTestSelect, {
                            data: tortureTestData,
                            stickyHeaders: true,
                            searchBar: true
                        });
                    </script>

                    <select multiple="multiple" id="tortureTestSelect"></select>

                </template>

            </section>

            <section>
                <h4>Contributing</h4>

                <p>
                    If you would like to contribute to DualMultiSelect, please feel free to fork the repository and submit a pull request.<br>
                    If you have any issues or have feature requests, please submit submit them on the <a href="https://github.com/hhoweson/DualMultiSelect">GitHub repository</a>.
                    <br><br>
                    <b>Feature ideas:</b>
                    <ul>
                        <li>Better mobile support (dynamic resizing)</li>
                        <li>Custom themes</li>
                        <li>Keyboard navigation support for accessibility.</li>
                        <li>Additional accessibility support eg. ARIA attributes</li>
                        <li>Make collapsible option groups option</li>
                    </ul>
                </p>
            </section>

        </div>

    </body>
</html>